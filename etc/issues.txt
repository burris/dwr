
Killing a comet request
	How to reproduce:
	(I use DWR 1.1.1)
	Use XMLHttpRequest method and Internet Explorer (tested at
	6.0.2900.2180.xpsp_sp2_rtm.040803-2158).
	Start a long request and close the browser while the request is pending.
	From now on the browser behaves very strange - re-opening the page leads to a
	white screen, an empty status bar...
	One has to restart IE.	
	As a workaround I tried the IFrame method but it does not seem to work with
	multiple asynchronous requests (neither on Firefox nor on IE).


ScriptSession was invalidated
	I'm using reverse ajax in M2.
	I get sometimes alerts with 'ScriptSession was invalidated', I'm not
	sure what causes them, but it seems that after an alert or two
	everything works OK; is there a place to disable or catch them?
	


XHR headers
	I also read a recent posted question on setting
	headers, and you asked why it was needed.
	
	Let me explain where I see a need.
	
	At our site, we use Spring and Acegi where we have
	written and/or use Acegi filters that look at the
	request authentication information in the request
	header.  Typically this is WSSE authentication
	information.
	
	As I started to look at DWR, I wanted to continue to
	leverage this capability, but to do so, I would need
	to set the request headers with the appropriate
	information.  If successful the filter will just pass
	the information to the DWR servlet for processing.
	
	Can you tell me if there is a way in either version of
	DWR to set this information? Of if you see another way
	around this, that would be helpful.

ScriptSession has been invalided
	We get this "ScriptSession has been invalided" error every once in a while.

Stuff I'm working on:
- Accessibility. DWR should integrate with screen readers to tell them when a page has changed

Stuff that would be cool:
- WDDX stuff from Rob Gonda
- Overloaded objects marshaled to correct types
- Hierarchical DWRUtil.[g|s]etValues

Audit all MarshallExceptions - they could go to the client

accessibility

make sure that the exec calls never pass back an exception. catch and emit some good javascript

onbackbutton, onforwardbutton

DwrUtil serious bug
	I believe I found a bug in DWR 2.0 milestone 2:
	It all starts in file DWRUtil.java, method setValue(String elementId, String 
	value, boolean escapeHtml)
	In the original code the following lines exist (exhibit 1):	
		OutboundVariable elementIdOv = getWebContext().toJavascript(elementId);
		OutboundVariable valueOv = getWebContext().toJavascript(value);
	These methods lead to this code in class DefaultWebContext (exhibit 2):	
		public OutboundVariable toJavascript(Object data) throws MarshallException
		{
		  return getConverterManager().convertOutbound(data, new OutboundContext());
		}
	Subsequently the program reaches ConverterUtil.addStringInit(String output, 
	OutboundContext outctx) which created the error in the line (exhibit 3):	
		// For medium length strings do it in a separate variable
		if (escaped.length() < WRAP_LENGTH)
		{
		  OutboundVariable ov = outctx.createOutboundVariable(output);
		  String varname = ov.getAssignCode();
		  ov.setInitCode("var " + varname + "=\"" + escaped + "\";\r\n");
		  return ov;
		}
	Each of the multiple calls in exhibit 1 create a new outbound context in 
	exhibit 2. When the program reached eventually the position of exhibit 3 it 
	created twice the Javascript variable s0 leading to the following Javascript:	
		var s0="imageSrc";
		var s0="image_fill_up_to_more_than_20_characters.png";
		DWRUtil.setValue(s0,s0);
	Although I am not certain that my solution actually solves all issues, it 
	seems to work for me.
	I added to interface WebContext the method:
	OutboundVariable toJavascript(Object data, OutboundContext aContext) throws 
	MarshallException;
	and implemented it in all derived classes, especially in DefaultWebContext as:
		public OutboundVariable toJavascript(Object data, OutboundContext aContext) 
		throws MarshallException
		{
		  return getConverterManager().convertOutbound(data, aContext);
		}
	Then I changed DWRUtil.java, method setValue(String elementId, String value, 
	boolean escapeHtml) as such:	
		OutboundContext outputContext = new OutboundContext();
		OutboundVariable elementIdOv = getWebContext().toJavascript(elementId, 
		outputContext);
		OutboundVariable valueOv = getWebContext().toJavascript(value, outputContext);
	

Multiple call issue
	When calling the same function 4 times consecutively passing a different
	paramter the same result is always returned.  While debugging on the server side
	(jboss), I have noted that the result passed back (a collection) is different.
	However, DWR appears to be getting confused and always returns the same result
	for each call.
	I have noticed that if I put each call between a begin/endbatch that the correct
	result is returned.
	This is only for 1.1.  1.0 does not have this issue.
	LabBean.getMaterials(displayMaterialJewels, 1);
	LabBean.getMaterials(displayMaterialReversedItems, 2);
	LabBean.getMaterials(displayMaterialReversedJewels, 1);
	LabBean.getMaterials(displayMaterialItems, 2);

ie7 testing

timeout is broken

problems with oc4j??
	This is a berif description and I will send you my code soon.
	In my code I'm trying to call a java method from the jscript, where the java
	method returns a vector of objects and the returned value is reterived from
	the database, so every time the returned vector size could be changed, but
	in my case the returned vector has the same size every time however I'm sure
	that this vector is changed. What I could understand till now that this
	problem still accoured even I have restarted the jDeveloper and the whole
	windows.
	Thank you for your interest, and I will send you the code ASAP.

IFrame GET is broken with Safari
	iframe is only really useful with IE6 (with activex turned off) so we can
	ignore this breakage

Broken signatures
	We are users of DWR and have been trying to pass a javascript array of
	strings as a value in a Map from our client to our server and haven't been
	able to achieve the desired outcome however we have discovered the
	following.
	The client javascript looks something like :-
	      var refIds = new Array();
	      var count = 10;
	      for (var i = 0; i < count; i++) {
	            refIds[i] = i;
	      }
	    var params = new Object();
	    params.refIds = this.refIds;
	    QueryServiceGetLocationsDWRMethod.execute(dwrResponse, this.name, "handleResponse", requestId, params);
	The server side code looks something like :-
	    public QueryServiceGetLocationsDWRMethod.execute(String objectRef, String methodRef, String requestId, Map args)
	We are trying to pass the refIds array from the client to the server,
	expecting on the server side for DWR to build a map containing key/value
	entry of <String,String[]>
	We have configure the signatures section of dwr.xml to :-	
      <signatures>
		<![CDATA[
		import java.util.Map;
		import au.gov.vic.doi.xfc.web.service.query.QueryServiceGetLocationsDWRMethod;
		QueryServiceGetLocationsDWRMethod.execute(String, String, String, Map<String,[Ljava.lang.String;>);
		]]>
      </signatures>	
	The POST to the server contains :-
		callCount=1
		c0-scriptName=QueryServiceGetLocations
		c0-methodName=execute
		c0-id=3063_1144372351140
		c0-param0=string:Object1
		c0-param1=string:handleResponse
		c0-param2=string:reqId46
		c0-e2=number:0
		c0-e3=number:1
		c0-e4=number:2
		c0-e5=number:3
		c0-e6=number:4
		c0-e7=number:5
		c0-e8=number:6
		c0-e9=number:7
		c0-e10=number:8
		c0-e11=number:9
		c0-e1=Array:[reference:c0-e2,reference:c0-e3,reference:c0-e4,reference:c0-e5,reference:c0-e6,reference:c0-e7,reference:c0-e8,reference:c0-e9,reference:c0-e10,reference:c0-e11]
		c0-param3=Object:{refIds:reference:c0-e1}
		xml=true	
	Which looks correct to us.
	As you can see we are getting a map that contains a key/value pair where
	the value is a single string representing an array of object references
	rather than an array of string values (10 array elements in this example).
	In getting to the point we have, we have discovered the following :-
	   The SignatureParser class needs to be altered to take into account the
	   ClassLoader requires the string [Ljava.lang.String; to load the class as
	   an array of Strings. This string includes the ";" character which the
	   parser interprets as a line delimiter which in this case causes a
	   failure as thetokenized incorrectly tokenizes part lines.
	   We coded around this and the next parsing issue was that the "."
	   [Ljava.lang.String; string where being replaced with "$", the parser was
	   interpreting the string as representing an inner class, clearly this is
	   not the case. We coded around this and have now got to a point where the
	   [dwr-invoker]: Initialization successful is completing however we are
	   back to where we started in that whilst our code changes have taken us
	   through the parser successfully, the ArrrayConverter does not appear to
	   be doing its job as we are getting the same result as above where the
	   array is being constructed on the server as a single string of array
	   references.
	We're not able to spend more time on tracking down what's happening with
	ArrayConverter. It appears the ArrayConverter is working for the first
	level of indirection but not subsequent levels.
	Our fix for the first parser problem was to remove the ";" from the
	signatures section in the dwr.xml and if the class spec starts with an "["
	the append a ";" before loading the class, we simlely commented out the
	section of code that manages inner classes to get around the "$"
	substitution problem.
	Thanks Dan.

Simple Date format
	There are also notes here:
	http://getahead.ltd.uk/dwr/server/dwrxml/converters
	This is something that keeps on being mentioned. At some stage maybe we
	should consider creating a simple Javascript version of SimpleDateFormat
	that would help people get this job done more quickly.

Beans extending hashmap - Kristján Bjarni Guðmundsson <kristjg@hugvit.is>
	I have a class that extends HashMap, and I define that it should be
	converted using the bean converter, however it always get converted
	using the map converter. Is there any way to specify that it should be
	converted as a bean?
	Joe: This ought to work because DWR should pick the more specific
	declaration. I'll add it to the list of issues.

Response Size Limits
    My collection has 20.000 objects(string not so large) the size of each
    object is 74 bytes. After 20 thousands elements I have problems, the client
    side doesn't show me the result. Do u have any idea to help?  or something?
    i got the firebug but didn't help. Sometime I received a dialog box
    "InternalError: Too many literals".

Test with Dojo and Prototype.

Asynchronous batches
	I set my call to be synchronous:	
		DWREngine.setAsync(false);
		ClientRequest.request(ri, defaultCallBack);
	The call is executed as it supposed to. But then I get a JavaScript error
	from DWR saying "[object Error]". When I step through the engine.js code I
	found the following lines in function DWREngine._endBatch
		DWREngine._sendData(batch);
		DWREngine._batches[DWREngine._batches.length] = batch;
	Where second line never gets executed if synchronous is set.  That means that
	DWREngine._batches collection is EMPTY.
	As a result in DWREngine._handleResponse function the following line
	returns 'undefined' and causes error:
	     var responseBatch = DWREngine._batches[DWREngine._batches.length-1];
	Because chain of calls stops at this moment DWREngine._clearUp(batch)
	never gets called for synchronous call.

Add checks for Javascript reserved names
	In using DWR one nasty issue I came across was that my bean had a property
	called default - my ajax call kept failing and I couldn't figure out why
	till I looked at the generated variables and saw that it was because the
	generated code put in a value for default and javascript didn't like it.
	Maybe as a warning, look at bean properties and see if there are a conflicts
	with reserved keywords.

New Converters for java.util.Currency and java.net.URL

Response already committed
	Is it normal to get "INFO [org.apache.jk.core.MsgContext] - Response already
	committed" message to log files every 25 secs when you have called the
	"DWREngine.setReverseAjax(true)"? I know that the long request is cut out
	around every 30 sec or so, so I believe the message is coming from that, the
	question is more that is this normal? I'm using tomcat 5.5.7 and apache httpd
	2.0 with jk_mod. I've tested this with my own code and with the 2.0M2 example
	chat code.
	...
	Thanks for quick reply. It's definetly something to do with the Apache
	facading the tomcat. When I connected straight to tomcat it doesn't write
	that to the log. Here is the threads from the debug if this helps you at all:
	TP-Processor2@4 daemon, priority=5, in group 'main', status: 'RUNNING'
	action():249, MsgContext.java
	action():182, Response.java
	doFlush():322, OutputBuffer.java
	flush():293, OutputBuffer.java
	flush():94, CoyoteWriter.java
	flush():270, PrintWriter.java
	checkError():306, PrintWriter.java
	sendScript():417, DwrpPlainJsMarshaller.java
	marshallOutbound():367, DwrpPlainJsMarshaller.java
	handle():131, UrlProcessor.java
	doPost():188, DwrServlet.java
	service():709, HttpServlet.java
	service():802, HttpServlet.java
	...

